<!DOCTYPE html>
<html>

<head>
  <title>Discogs Wantlist Helper</title>
  <link rel="stylesheet" href="../styles/popup.css">
  <meta charset="UTF-8">
</head>

<body>

  <div class="header">
    <img class="discogs-logo" src="../assets/images/discogs_logo.png" alt="Discogs Logo">
    <h1 class="title">Wantlist Helper</h1>
    <small>1.0</small>
  </div>

  <div class="content" x-data="popup" x-init="displayUser()">
    <div class="container">
      <div x-show="loading" class="loading-message">
        <img src="../assets/images/loader.gif" class="w-4 h-4" />
        <span>Loading...</span>
      </div>

      <div x-show="!loading && authorized" class="status">
        <img class="avatar" :src="userDetails.avatar_url">
        <a :href="userDetails.uri" target="_blank" x-text="userDetails.name"></a>
        <i class="fa-solid fa-barcode"></i>
        <span x-text="userDetails.num_collection"></span>
        <i class="fa-solid fa-eye"></i>
        <span x-text="userDetails.num_wantlist"></span>
      </div>

      <button @click="initAuthFlow()" class="primary-button" x-show="!loading && !authorized">Authorize Discogs</button>
    </div>

    <form @submit.prevent="handleSubmit" class="form" id="submitForm" x-show="!loading && authorized">
      <input class="form-input" x-model="releaseId" id="releaseId" name="releaseId" type="number"
        placeholder="Enter URL or release ID">
      <button class="primary-button" id="addManually">Add</button>
    </form>

    <template x-if="message">
      <div class="response-message">
        <i class="fa-solid fa-circle-check"></i>
        <small x-text="message"></small>
      </div>
    </template>

    <template x-if="error">
      <div class="error-message">
        <i class="fa-solid fa-triangle-exclamation"></i>
        <small x-text="error"></small>
      </div>
    </template>

    <template x-if="release">
      <div class="release-container">
        <div class="release-details">
          <span class="release-title">
            <a :href="release.uri" target="_blank" x-text="release.title"></a>
          </span>
          <span x-text="release.artists"></span>
          <span class="release-year" x-text="release.year"></span>
        </div>
        <img class="release-thumb" :src="release.thumb" />
      </div>
    </template>
  </div>

  <script type="module" src="./popup.js"></script>
</body>

</html>
